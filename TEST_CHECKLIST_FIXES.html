<!DOCTYPE html>
<html>
<head>
    <title>Test Checklist: Quiz Validation Fix</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial; background: #f5f5f5; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 30px; }
        h1 { color: #333; margin-bottom: 10px; }
        .subtitle { color: #666; margin-bottom: 30px; font-size: 16px; }
        .section { margin: 30px 0; }
        .section-title { font-size: 18px; font-weight: bold; color: #222; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #ddd; }
        .checklist-item { display: flex; align-items: flex-start; margin: 12px 0; padding: 12px; background: #f9f9f9; border-radius: 6px; }
        .checklist-item:hover { background: #f0f0f0; }
        input[type="checkbox"] { width: 20px; height: 20px; margin-right: 12px; margin-top: 2px; cursor: pointer; }
        .checklist-text { flex: 1; }
        .checklist-text label { cursor: pointer; display: block; margin-bottom: 4px; }
        .checklist-text .detail { color: #666; font-size: 13px; margin-top: 4px; }
        .expected { background: #e8f5e9; padding: 8px 12px; border-left: 3px solid #4caf50; margin-left: 32px; margin-top: 8px; font-size: 13px; border-radius: 4px; }
        .error { background: #ffebee; padding: 8px 12px; border-left: 3px solid #f44336; margin-left: 32px; margin-top: 8px; font-size: 13px; border-radius: 4px; }
        .info { background: #e3f2fd; padding: 8px 12px; border-left: 3px solid #2196f3; margin-left: 32px; margin-top: 8px; font-size: 13px; border-radius: 4px; }
        input[type="checkbox"]:checked + .checklist-text label { text-decoration: line-through; color: #999; }
        .progress-bar { width: 100%; height: 8px; background: #ddd; border-radius: 4px; margin: 20px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: #4caf50; width: 0%; transition: width 0.3s; }
        .stats { display: flex; gap: 20px; margin: 20px 0; }
        .stat { flex: 1; padding: 15px; background: #f5f5f5; border-radius: 6px; text-align: center; }
        .stat-value { font-size: 24px; font-weight: bold; color: #333; }
        .stat-label { color: #666; font-size: 13px; margin-top: 5px; }
        .button-group { display: flex; gap: 10px; margin: 20px 0; }
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: bold; }
        .btn-primary { background: #2196f3; color: white; }
        .btn-primary:hover { background: #1976d2; }
        .btn-success { background: #4caf50; color: white; }
        .btn-success:hover { background: #45a049; }
        .code-block { background: #f5f5f5; padding: 12px; border-radius: 4px; font-family: monospace; font-size: 12px; overflow-x: auto; margin: 10px 0; border-left: 3px solid #999; }
        .fixed { background: #c8e6c9; }
        .broken { background: #ffcccc; }
        .summary { background: #fff9e6; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107; margin: 20px 0; }
        .summary h3 { color: #f57f17; margin-bottom: 10px; }
        .summary p { margin: 5px 0; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Checklist: Quiz Validation Fix</h1>
        <p class="subtitle">V√©rifiez que les corrections appliqu√©es fonctionnent correctement</p>

        <div class="summary">
            <h3>üìå R√©sum√© des Corrections</h3>
            <p>‚úÖ <strong>FIX #1</strong>: Ajouter definition des variables globales window.currentChapitreId et window.currentStepId</p>
            <p>‚úÖ <strong>FIX #2</strong>: Corriger appel √† updateStepIcons() comme fonction globale au lieu de this.updateStepIcons()</p>
        </div>

        <!-- Pre-Test Setup -->
        <div class="section">
            <div class="section-title">üîß Pr√©paration (Avant Test)</div>
            <div class="checklist-item">
                <input type="checkbox" id="setup1">
                <div class="checklist-text">
                    <label for="setup1">Rafra√Æchir la page (Ctrl+F5 ou Cmd+Shift+R)</label>
                    <div class="detail">Charge le code modifi√©</div>
                </div>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="setup2">
                <div class="checklist-text">
                    <label for="setup2">Ouvrir DevTools (F12) ‚Üí Console</label>
                    <div class="detail">Pour v√©rifier qu'il n'y a pas d'erreurs</div>
                </div>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="setup3">
                <div class="checklist-text">
                    <label for="setup3">Acc√©der √† un chapitre (ex: "Proc√©dures douani√®res")</label>
                    <div class="detail">Pour voir la vue SVG du chapitre</div>
                </div>
            </div>
        </div>

        <!-- Quiz Test -->
        <div class="section">
            <div class="section-title">üìù Test Principal: Validation du Quiz</div>
            
            <div class="checklist-item">
                <input type="checkbox" id="quiz1">
                <div class="checklist-text">
                    <label for="quiz1">Cliquer sur l'√©tape 6 (Quiz)</label>
                    <div class="detail">Devrait afficher le Quiz avec 3 questions</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="quiz2">
                <div class="checklist-text">
                    <label for="quiz2">R√©pondre aux questions (>= 50% correct)</label>
                    <div class="detail">Exemple: R√©pondre correctement √† 2-3 questions sur 3</div>
                    <div class="expected">‚úÖ EXPECTED: Les r√©ponses s'affichent en VERT (correct) ou ROUGE (incorrect)</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="quiz3">
                <div class="checklist-text">
                    <label for="quiz3">Cliquer le bouton "‚úì Valider Quiz"</label>
                    <div class="detail">Lance la validation des r√©ponses</div>
                    <div class="expected">‚úÖ EXPECTED: Pas d'erreur JavaScript en console</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="quiz4">
                <div class="checklist-text">
                    <label for="quiz4">Observer la console apr√®s validation</label>
                    <div class="detail">Chercher les messages de succ√®s</div>
                    <div class="info">üí° V√âRIFIER: Le message "‚úÖ Set window variables: currentChapitreId=..." s'affiche-t-il?</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="quiz5">
                <div class="checklist-text">
                    <label for="quiz5">Notification de succ√®s "üéä Quiz compl√©t√©!"</label>
                    <div class="detail">Devrait s'afficher pendant 2-3 secondes</div>
                    <div class="expected">‚úÖ EXPECTED: Message avec le pourcentage obtenu (ex: "100% (3/3 bonnes r√©ponses)")</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="quiz6">
                <div class="checklist-text">
                    <label for="quiz6">V√©rifier que l'icon Quiz devient VERTE (‚úÖ)</label>
                    <div class="detail">Dans la vue SVG du chapitre</div>
                    <div class="expected">‚úÖ EXPECTED: L'icon de l'√©tape 6 passe de ORANGE (‚ö°) √† VERT (‚úÖ) IMM√âDIATEMENT</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="quiz7">
                <div class="checklist-text">
                    <label for="quiz7">V√©rifier le bouton "√âtape suivante"</label>
                    <div class="detail">V√©rifie que le bouton est activ√© pour aller au Portfolio</div>
                    <div class="expected">‚úÖ EXPECTED: Le bouton "√âtape suivante ‚Üí" est ACTIV√â (pas gris√©), avec opacity 100%</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="quiz8">
                <div class="checklist-text">
                    <label for="quiz8">V√©rifier la console pour erreurs</label>
                    <div class="detail">Aucune erreur TypeError ne devrait appara√Ætre</div>
                    <div class="error">‚ùå ERREUR SI: "TypeError: this.updateStepIcons is not a function" s'affiche</div>
                    <div class="error">‚ùå ERREUR SI: "Chapitre ch1 non trouv√© dans aucun niveau" s'affiche</div>
                </div>
            </div>
        </div>

        <!-- Portfolio Test -->
        <div class="section">
            <div class="section-title">üé® Test Secondaire: Portfolio</div>
            
            <div class="checklist-item">
                <input type="checkbox" id="port1">
                <div class="checklist-text">
                    <label for="port1">Cliquer "√âtape suivante" pour acc√©der au Portfolio (√©tape 7)</label>
                    <div class="detail">Devrait afficher les cartes de portfolio pour swiper</div>
                    <div class="expected">‚úÖ EXPECTED: Les cartes du portfolio s'affichent correctement</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="port2">
                <div class="checklist-text">
                    <label for="port2">Swiper toutes les cartes du portfolio</label>
                    <div class="detail">Glisser de droite √† gauche pour √©valuer chaque th√®me</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="port3">
                <div class="checklist-text">
                    <label for="port3">Observer le message "üéâ Plan de r√©vision termin√©!"</label>
                    <div class="detail">Devrait s'afficher √† la fin du portfolio</div>
                    <div class="expected">‚úÖ EXPECTED: Stats et plan de r√©vision s'affichent</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="port4">
                <div class="checklist-text">
                    <label for="port4">V√©rifier que l'icon Portfolio devient VERTE (‚úÖ)</label>
                    <div class="detail">Retourner √† la vue du chapitre</div>
                    <div class="expected">‚úÖ EXPECTED: L'icon Portfolio est VERT (‚úÖ), pas GRIS ou ORANGE</div>
                </div>
            </div>
        </div>

        <!-- Final Chapter Test -->
        <div class="section">
            <div class="section-title">üèÅ Test Final: Chapitre Compl√©t√©</div>
            
            <div class="checklist-item">
                <input type="checkbox" id="final1">
                <div class="checklist-text">
                    <label for="final1">Retourner √† la vue du chapitre</label>
                    <div class="detail">Cliquer sur "‚Üê Retour au chapitre"</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="final2">
                <div class="checklist-text">
                    <label for="final2">V√©rifier que TOUS les icons sont VERTS (‚úÖ)</label>
                    <div class="detail">Les 7 √©tapes + Objectifs doivent avoir le symbole ‚úÖ</div>
                    <div class="expected">‚úÖ EXPECTED: 
                        <br>- 1√®re ligne: ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ 
                        <br>- 2√®me ligne: ‚úÖ ‚úÖ (sans ‚ö° orange ou üîí gris)
                    </div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="final3">
                <div class="checklist-text">
                    <label for="final3">V√©rifier que "100% compl√©t√©" s'affiche</label>
                    <div class="detail">Dans la barre de progression du chapitre</div>
                    <div class="expected">‚úÖ EXPECTED: Progression = 100%, barre remplie compl√®tement</div>
                </div>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="final4">
                <div class="checklist-text">
                    <label for="final4">V√©rifier la console pour "Progression du chapitre"</label>
                    <div class="detail">Tous les messages de progression devraient √™tre en vert (‚úÖ)</div>
                    <div class="expected">‚úÖ EXPECTED: Pas d'erreur, tous les logs montrent succ√®s</div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="section">
            <div class="section-title">üìä R√©sultats</div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>

            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="checkedCount">0</div>
                    <div class="stat-label">Compl√©t√©s</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="totalCount">0</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="percentCount">0%</div>
                    <div class="stat-label">Progression</div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="resetChecklist()">üîÑ R√©initialiser</button>
                <button class="btn btn-success" onclick="printResults()">üìã Imprimer R√©sultats</button>
            </div>
        </div>

        <!-- Summary -->
        <div class="summary">
            <h3>‚úÖ Si TOUT est coch√©: LES BUGS SONT FIX√âS!</h3>
            <p>Les deux corrections ont fonctionn√© correctement:</p>
            <p>1. ‚úÖ Variables globales (window.currentChapitreId, window.currentStepId) sont d√©finies</p>
            <p>2. ‚úÖ updateStepIcons() est appel√©e correctement comme fonction globale</p>
            <p>3. ‚úÖ Quiz validation fonctionne et met √† jour les ic√¥nes en vert</p>
            <p>4. ‚úÖ Progression vers Portfolio est possible</p>
        </div>
    </div>

    <script>
        // Count checkboxes
        function updateProgress() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const checked = document.querySelectorAll('input[type="checkbox"]:checked').length;
            const total = checkboxes.length;
            const percent = Math.round((checked / total) * 100);

            document.getElementById('checkedCount').textContent = checked;
            document.getElementById('totalCount').textContent = total;
            document.getElementById('percentCount').textContent = percent + '%';
            document.getElementById('progressFill').style.width = percent + '%';
        }

        // Reset
        function resetChecklist() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateProgress();
        }

        // Print results
        function printResults() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            let report = 'TEST RESULTS\n' + '='.repeat(50) + '\n\n';
            
            checkboxes.forEach((cb, idx) => {
                const label = cb.nextElementSibling.querySelector('label').textContent;
                report += (cb.checked ? '‚úÖ' : '‚ùå') + ' ' + label + '\n';
            });

            const checked = document.querySelectorAll('input[type="checkbox"]:checked').length;
            const total = checkboxes.length;
            report += '\n' + '='.repeat(50) + '\n';
            report += `SCORE: ${checked}/${total} (${Math.round((checked/total)*100)}%)\n`;

            alert(report);
            console.log(report);
        }

        // Initialize
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
            cb.addEventListener('change', updateProgress);
        });
        updateProgress();
    </script>
</body>
</html>
